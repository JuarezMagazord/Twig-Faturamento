{# USE O ID DO PRODUTO E NÃO O SKU Solicitado na Tarefa #90355 Ticket 322553 Também inserir os ID's no template ICMS_SITUACAO_TRIB #}

{% set baseCalculo = (self.notaFiscalItem.valorUnitario * self.notaFiscalItem.quantidade) + self.notaFiscalItem.valorFrete + self.notaFiscalItem.valorOutrasDespesas - self.notaFiscalItem.valorDesconto %}

    {% if self.notaFiscalItem.getProdutoDerivacao().getId() is not null and self.notaFiscalItem.getProdutoDerivacao().getId() in [266, 313, 2263, 314, 311, 309, 310, 3080, 456, 2804, 2805, 2803, 2802, 2809, 2810, 2808, 2807, 3075, 2662, 2664, 498, 499, 2158, 2159, 2154, 2155, 2156, 2710, 2709, 2707, 2706, 619, 2167, 2161, 2162, 2163, 2164, 2165, 623, 627, 626, 625, 2720, 651, 3117, 3119, 3118, 3110, 3111, 2326, 3297, 3287, 3289, 3296, 3291, 3286, 3295, 657, 3294, 658, 659, 3292, 660, 3288, 3290, 3293, 4271, 3121, 3122, 3123, 2169, 2170, 2171, 2173, 2174, 2175, 2176, 2177, 2713, 2712, 810, 807, 2694, 808, 812, 813, 814, 815, 2260, 3755, 4297, 4298, 4299, 4296, 4300, 4301, 4302, 4303, 4324, 1703, 3919, 2179, 2180, 2181, 2182, 2184, 2185, 2186, 2187, 2189, 2190, 2191, 2192, 900, 2716, 902, 898, 2568, 2193, 896,  2194, 908, 2195, 907, 2197, 2198, 2199, 2200, 2201, 2676, 2677, 2678, 2203, 2204, 2205, 2206, 2207, 2718, 2722, 969, 970, 971, 990, 2525, 1070, 1068, 1066, 1063, 1074, 1072, 2220, 1116, 1117, 1118, 1119, 1120, 1140, 1141, 1122,  1142, 1123, 2571, 1138, 2726, 2727, 2725, 2724, 1162, 1163, 1164, 1167, 1166, 1256, 1376, 2221, 2222, 1377, 2223, 1379, 1381, 1383, 1385, 1389, 1388, 1387, 2231, 2225, 2226, 2227, 2228, 2229, 2569, 1394, 1392, 1393, 1391, 2234, 1425, 3106, 1426,  3103, 3104, 1503, 3105, 3108, 3109, 3107, 3263, 1409, 2505, 2506, 2507, 2508, 2509, 3940, 3939, 3941, 3937,  3935, 3933, 2252, 2257, 2254, 2258, 2256, 2259, 2247, 2249, 1401, 1403, 1399, 1397, 2244, 2236, 2238, 2239, 2240, 2241, 2242, 2672, 2673, 2674] %}
        {% set baseCalculo = 0.00 %}
    {% else %}
        {% set baseCalculo = baseCalculo - (self.aliquotaICMS.percentualReducaoBaseCalculo / 100) * baseCalculo %}
    {% endif %}

{{ self.result(baseCalculo) }}